<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22 fill=%22%230000AA%22>:v</text></svg>">
<title>CONN3X10N</title>
<script src="https://cdn.jsdelivr.net/npm/gun/gun.js"></script>
<script src="https://cdn.jsdelivr.net/npm/gun/sea.js"></script>
<style>
@keyframes flicker{0%,100%{opacity:1}50%{opacity:0.97}}
@keyframes scanline{0%{transform:translateY(-100%)}100%{transform:translateY(100vh)}}
* { box-sizing: border-box; }
body {
  margin: 0;
  padding: 20px;
  min-height: 100vh;
  background: #0000AA;
  color: #fff;
  font-family: "Courier New", monospace;
  animation: flicker 0.15s infinite;
  display: flex;
  justify-content: center;
  align-items: center;
}
body::before {
  content: '';
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 2px;
  background: linear-gradient(transparent, rgba(255,255,255,0.1), transparent);
  animation: scanline 8s linear infinite;
  pointer-events: none;
  z-index: 1000;
}
.container { width: 100%; max-width: 350px; }
.logo {
  border: 2px solid #fff;
  display: inline-block;
  padding: 4px 16px;
  margin-bottom: 20px;
  text-decoration: none;
  color: #fff;
}
.logo span { background: #fff; color: #0000AA; padding: 0 4px; font-weight: bold; }
.logo:hover { background: #fff; }
.window {
  background: #C0C0C0;
  border: 2px solid;
  border-color: #fff #808080 #808080 #fff;
  box-shadow: 4px 4px 0 #000;
}
.window-header {
  background: linear-gradient(90deg, #000080, #1084d0);
  color: #fff;
  padding: 6px 10px;
  font-weight: bold;
  font-size: 13px;
}
.window-content { padding: 15px; }
.field { margin-bottom: 12px; }
.field label {
  display: block;
  color: #000;
  font-weight: bold;
  margin-bottom: 4px;
  font-size: 12px;
}
.field input {
  width: 100%;
  padding: 8px;
  font-family: "Courier New", monospace;
  font-size: 14px;
  border: 2px inset #808080;
  background: #fff;
}
.field input:focus { outline: none; background: #ffffcc; }
.btn {
  width: 100%;
  padding: 10px;
  background: #C0C0C0;
  border: 2px solid;
  border-color: #fff #808080 #808080 #fff;
  font-family: "Courier New", monospace;
  font-size: 14px;
  font-weight: bold;
  cursor: pointer;
  color: #000;
}
.btn:hover { background: #d4d4d4; }
.btn:active { border-color: #808080 #fff #fff #808080; }
.btn-primary { background: #000080; color: #fff; }
.btn-primary:hover { background: #0000AA; }
.message {
  padding: 8px;
  margin-bottom: 12px;
  border: 2px solid;
  font-size: 11px;
  display: none;
}
.message.error { background: #ffcccc; border-color: #cc0000; color: #cc0000; display: block; }
.message.success { background: #ccffcc; border-color: #00cc00; color: #006600; display: block; }
.message.info { background: #cce5ff; border-color: #0066cc; color: #004499; display: block; }
.info-box {
  background: #ffffcc;
  border: 1px solid #808080;
  padding: 8px;
  margin-top: 12px;
  font-size: 11px;
  color: #000;
}
.info-box a { color: #000080; }
.logged-in { text-align: center; padding: 15px; }
.logged-in .username { font-size: 20px; color: #000080; margin: 10px 0; }
.nav-links { display: flex; gap: 8px; margin-top: 12px; }
.nav-links a {
  flex: 1;
  padding: 8px;
  background: #000080;
  color: #fff;
  text-decoration: none;
  text-align: center;
  font-weight: bold;
  font-size: 12px;
  border: 2px solid;
  border-color: #fff #808080 #808080 #fff;
}
.nav-links a:hover { background: #0000AA; }
</style>
</head>
<body>

<div class="container">
  <a href="menu.html" class="logo"><span>:vitalism</span></a>
  
  <div class="window">
    <div class="window-header">üîê Connexion</div>
    
    <div class="window-content">
      <div id="loginForm">
        <div id="messageBox"></div>
        
        <form onsubmit="login(event)">
          <div class="field">
            <label>Pseudo</label>
            <input type="text" id="loginUsername" required autocomplete="username">
          </div>
          <div class="field">
            <label>Mot de passe</label>
            <input type="password" id="loginPassword" required autocomplete="current-password">
          </div>
          <button type="submit" class="btn btn-primary">Connexion</button>
        </form>
        
        <div class="info-box">
          Pas de compte ? <a href="candidature.html">Remplir une candidature</a>
        </div>
      </div>
      
      <div id="loggedIn" style="display:none;">
        <div class="logged-in">
          <div style="font-size:32px;">‚úÖ</div>
          <div class="username" id="displayUsername"></div>
          <div style="color:#000;font-size:11px;">Connect√©</div>
          
          <div class="nav-links">
            <a href="chatbox.html">üí¨ Chat</a>
            <a href="forum.html">üìã Forum</a>
          </div>
          
          <button class="btn" style="margin-top:12px;font-size:11px;" onclick="logout()">D√©connexion</button>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
const gun = Gun({ peers: ['https://gun-manhattan.herokuapp.com/gun', 'https://gun-us.herokuapp.com/gun'] });
const user = gun.user().recall({ sessionStorage: true });

gun.on('auth', () => showLoggedIn());
setTimeout(() => { if (user.is) showLoggedIn(); }, 500);

function showMessage(text, type) {
  const box = document.getElementById('messageBox');
  box.innerHTML = '<div class="message ' + type + '">' + text + '</div>';
}

function login(e) {
  e.preventDefault();
  const username = document.getElementById('loginUsername').value.trim();
  const password = document.getElementById('loginPassword').value;
  showMessage('Connexion...', 'info');
  user.auth(username, password, (ack) => {
    if (ack.err) {
      showMessage('Pseudo ou mot de passe incorrect', 'error');
    } else {
      showLoggedIn();
    }
  });
}

function showLoggedIn() {
  document.getElementById('loginForm').style.display = 'none';
  document.getElementById('loggedIn').style.display = 'block';
  document.getElementById('displayUsername').textContent = user.is.alias;
  localStorage.setItem('vitalism-user', JSON.stringify({ username: user.is.alias, pub: user.is.pub }));
}

function logout() {
  user.leave();
  localStorage.removeItem('vitalism-user');
  location.reload();
}
</script>
</body>
</html>
