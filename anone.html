<!DOCTYPE html>
<html lang="fr">
<head>
<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22 fill=%22%230000AA%22>:v</text></svg>">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>//AN0NE_01</title>
<script src="https://cdn.jsdelivr.net/npm/gun/gun.js"></script>
<script src="https://cdn.jsdelivr.net/npm/gun/sea.js"></script>
<style>
@keyframes blink { 0%,49%{opacity:1;}50%,100%{opacity:0;} }
@keyframes flicker { 0%,100%{opacity:1;}50%{opacity:0.96;} }
@keyframes scanline { 0%{transform:translateY(-100%);}100%{transform:translateY(100vh);} }

* { cursor: none !important; box-sizing: border-box; }

body {
  background-color: #0000AA;
  color: #FFFFFF;
  font-family: "Courier New", monospace;
  font-size:14px;
  margin:0;
  padding:40px;
  min-height:100vh;
  animation: flicker 0.15s infinite;
  text-shadow:0 0 2px rgba(255,255,255,0.5);
  position: relative;
  overflow: hidden;
}

body::before {
  content: '';
  position:fixed;
  top:0; left:0; width:100%; height:2px;
  background: linear-gradient(transparent, rgba(255,255,255,0.1), transparent);
  animation: scanline 8s linear infinite;
  pointer-events:none; z-index:1000;
}

body::after {
  content:'';
  position:fixed; top:0; left:0; right:0; bottom:0;
  background: repeating-linear-gradient(0deg, rgba(0,0,0,0.15), rgba(0,0,0,0.15) 1px, transparent 1px, transparent 2px);
  pointer-events:none; z-index:999;
}

.content { position: relative; z-index:1; max-width:800px; margin:0 auto; }

.logo { border:2px solid #FFFFFF; display:inline-block; padding:4px 16px; margin-bottom:20px; cursor:pointer; transition:all 0.2s; text-decoration:none; }
.logo:hover { background:#FFFFFF; }
.logo:hover span { color:#0000AA; }
.logo span { background-color:#FFFFFF; color:#0000AA; padding:0 4px; font-weight:bold; font-size:18px; }

.terminal-boot { margin-bottom:30px; font-size:13px; line-height:1.6; }
.boot-line { color:#AAAAAA; margin:3px 0; }
.cursor-blink { animation: blink 1s infinite; }

.custom-cursor { position: fixed; width:16px; height:16px; background-color:#FFFFFF; pointer-events:none; z-index:10000; mix-blend-mode:difference; display:none; }
body:hover .custom-cursor { display:block; }

#typingArea {
  min-height:calc(100vh - 350px);
  outline:none;
  font-size:16px;
  line-height:1.8;
  padding:20px 0;
  color:#FFFFFF;
  word-wrap:break-word;
  white-space:pre-wrap;
  caret-color:transparent;
  position:relative;
}

#typingArea:focus::after {
  content:'‚ñà';
  color:#FFFFFF;
  animation:blink 1s infinite;
  position:absolute;
  margin-left:2px;
}

#submitBtn {
  position:fixed;
  bottom:80px;
  right:40px;
  padding:12px 24px;
  background:#C0C0C0;
  border-top:2px solid #FFFFFF;
  border-left:2px solid #FFFFFF;
  border-bottom:2px solid #000000;
  border-right:2px solid #000000;
  font-family:"Courier New", monospace;
  font-weight:bold;
  font-size:13px;
  cursor:pointer;
  color:#000000;
  transition:all 0.3s;
  box-shadow:4px 4px 0 #000000;
  opacity:0;
}

#submitBtn:hover { background:#DFDFDF; }
#submitBtn:active {
  border-top:2px solid #000000;
  border-left:2px solid #000000;
  border-bottom:2px solid #FFFFFF;
  border-right:2px solid #FFFFFF;
}

#submitBtn.secret-mode {
  background:#000080;
  color:#fff;
  border:2px solid #0ff;
  animation:blink 0.5s 3;
}

#statusIndicator {
  position:fixed;
  bottom:20px;
  left:20px;
  padding:4px 10px;
  background:#C0C0C0;
  border-top:2px solid #FFFFFF;
  border-left:2px solid #FFFFFF;
  border-bottom:2px solid #808080;
  border-right:2px solid #808080;
  font-size:11px;
  color:#000000;
  font-weight:bold;
  box-shadow:1px 1px 0 #000000;
}

@media (max-width:768px){
  body { padding:20px; }
  #submitBtn { right:20px; bottom:100px; }
}
</style>
</head>
<body>
<div class="custom-cursor" id="cursor"></div>

<div class="content">
  <a href="menu.html" class="logo"><span>:vitalism</span></a>

  <div class="terminal-boot">
    <div class="boot-line">VITALISM CONTACT SYSTEM v2.1</div>
    <div class="boot-line">Copyright (C) 1995-20// Vitalism Corp.</div>
    <div class="boot-line" style="margin-top:10px;">Loading ANONE.COLLEGE protocol...</div>
    <div class="boot-line">Initializing encryption layer................ [OK]</div>
    <div class="boot-line">Mounting anonymous routing table............. [OK]</div>
    <div class="boot-line">Connecting to network nodes.................. [OK]</div>
    <div class="boot-line">Loading cryptographic modules................ [OK]</div>
    <div class="boot-line" style="margin-top:10px;">ANONE_POOL[12] nodes detected</div>
    <div class="boot-line">System ready. Begin transmission.</div>
    <div class="boot-line" style="margin-top:10px; color:#00FF00;">C:\VITALISM\CONTACT&gt;<span class="cursor-blink">_</span></div>
  </div>

  <div id="typingArea" contenteditable="true" spellcheck="false"></div>
  
  <div id="submitBtn">submit your feedback</div>

  <div id="statusIndicator">LISTENING</div>
</div>

<audio id="hookSound" src="byhook.mp3"></audio>

<script>
const cursor = document.getElementById('cursor');
document.addEventListener('mousemove', e => {
  cursor.style.left = e.clientX + 'px';
  cursor.style.top = e.clientY + 'px';
});

const anones = [
  "hephaistos@vitalism.net","athena@vitalism.net","gaia@vitalism.net","promethee@vitalism.net",
  "iris@vitalism.net","eros@vitalism.net","chronos@vitalism.net","nyx@vitalism.net",
  "hephaestus@vitalism.net","demeter@vitalism.net","pan@vitalism.net","selene@vitalism.net"
];

const typingArea = document.getElementById('typingArea');
const submitBtn = document.getElementById('submitBtn');
const statusIndicator = document.getElementById('statusIndicator');
const hookSound = document.getElementById('hookSound');

let originalText = '';
let charCount = 0;
let secretActivated = false;

const cryptChars = '‚ñë‚ñí‚ñì‚ñà‚ñÄ‚ñÑ‚ïê‚ïë‚ïî‚ïó‚ïö‚ïù‚ï†‚ï£‚ï¶‚ï©‚ï¨‚îå‚îê‚îî‚îò‚îú‚î§‚î¨‚î¥‚îº‚îÄ‚îÇ¬§¬ß¬∂‚Ä†‚Ä°¬∞¬¢¬£¬•∆íŒ±';

function encryptChar(char) {
  if (char === '\n' || char === ' ') return char;
  const intensity = Math.min(charCount / 100, 1);
  if (Math.random() < intensity) {
    return cryptChars[Math.floor(Math.random() * cryptChars.length)];
  }
  return char;
}

function encryptText(text) {
  return text.split('').map(char => encryptChar(char)).join('');
}

// Secret phrase detection
const secretPhrase = 'i am not a number, i am a free man';
const secretAlt = 'i am not a number i am a free man';

function checkSecret(text) {
  const lower = text.toLowerCase().trim();
  return lower.includes(secretPhrase) || lower.includes(secretAlt);
}

let typingTimeout;
typingArea.addEventListener('input', function() {
  clearTimeout(typingTimeout);
  
  originalText = typingArea.textContent;
  charCount = originalText.length;
  
  statusIndicator.textContent = charCount > 0 ? 'ENCODING' : 'LISTENING';
  
  // Check for secret phrase
  if (!secretActivated && checkSecret(originalText)) {
    secretActivated = true;
    submitBtn.textContent = 'WE WANT INFORMATION';
    submitBtn.classList.add('secret-mode');
    statusIndicator.textContent = '// PHRASE RECOGNIZED //';
  }
  
  if (charCount > 10) {
    submitBtn.style.opacity = '1';
  } else {
    submitBtn.style.opacity = '0';
  }
  
  typingTimeout = setTimeout(() => {
    if (charCount > 0 && !secretActivated) {
      const encrypted = encryptText(originalText);
      const cursorPos = saveCaretPosition(typingArea);
      typingArea.textContent = encrypted;
      restoreCaretPosition(typingArea, cursorPos);
      statusIndicator.textContent = 'ENCRYPTED';
    }
  }, 800);
});

// Gun.js pour messages avec chiffrement
const gun = Gun({ peers: ['https://gun-manhattan.herokuapp.com/gun', 'https://gun-us.herokuapp.com/gun'] });
const anoneMessages = gun.get('vitalism-anone-v2');

// Cl√© de chiffrement admin
const _SNYWOW='dTlWREJ6';
const _xGrwdi='T1dlb3Y0';
const _SIQJAd='U0VNc1Zz';
const _wQqeCK='bHVnV1N3';
const _rmZQxb='Z1IxN0dR';
const _lwgpBF='dUxoZVlQ';
const _bxLYhj='MHU2TQ==';
const _QUahNNgr=s=>atob(s);
const ADMIN_SECRET=_QUahNNgr(_SNYWOW+_xGrwdi+_SIQJAd+_wQqeCK+_rmZQxb+_lwgpBF+_bxLYhj);

submitBtn.addEventListener('click', async function() {
  if (charCount < 10) return;
  
  // SECRET PATH - redirect to hook.html
  if (secretActivated) {
    hookSound.volume = 0.7;
    hookSound.play().catch(()=>{});
    submitBtn.style.opacity = '0.5';
    submitBtn.style.pointerEvents = 'none';
    statusIndicator.textContent = '// CONNECTING TO VILLAGE... //';
    
    setTimeout(() => {
      window.location.href = 'hook.html';
    }, 2500);
    return;
  }
  
  // Normal path - envoyer √† Gun.js chiffr√©
  submitBtn.style.opacity = '0.5';
  submitBtn.style.pointerEvents = 'none';
  statusIndicator.textContent = 'ENCRYPTING...';
  
  const hash = Math.random().toString(16).substring(2, 10).toUpperCase();
  const msgId = 'anone_' + Date.now() + '_' + hash;
  
  // Donn√©es √† chiffrer
  const msgData = {
    id: msgId,
    message: typingArea.textContent,
    hash: '0x' + hash,
    charCount: charCount,
    timestamp: Date.now(),
    date: new Date().toISOString(),
    status: 'unread'
  };
  
  // Chiffrer le message
  const encrypted = await SEA.encrypt(JSON.stringify(msgData), ADMIN_SECRET);
  
  // Sauvegarder chiffr√©
  anoneMessages.get(msgId).put({
    id: msgId,
    encrypted: encrypted,
    timestamp: Date.now()
  });
  
  statusIndicator.textContent = 'TRANSMITTING';
  
  setTimeout(() => {
    statusIndicator.textContent = 'TX_SUCCESS';
    typingArea.textContent = `TX_SUCCESS | HASH: 0x${hash}\nDEST: ANONE_POOL[ENCRYPTED]\nPAYLOAD: ${charCount} BYTES\n\nüîí MESSAGE CHIFFR√â\nCONNECTION_TERMINATED`;
    
    setTimeout(() => {
      typingArea.textContent = '';
      originalText = '';
      charCount = 0;
      submitBtn.style.opacity = '0';
      submitBtn.style.pointerEvents = 'auto';
      statusIndicator.textContent = 'LISTENING';
    }, 5000);
  }, 1500);
});

function saveCaretPosition(element) {
  const selection = window.getSelection();
  if (selection.rangeCount > 0) {
    const range = selection.getRangeAt(0);
    const preCaretRange = range.cloneRange();
    preCaretRange.selectNodeContents(element);
    preCaretRange.setEnd(range.endContainer, range.endOffset);
    return preCaretRange.toString().length;
  }
  return 0;
}

function restoreCaretPosition(element, position) {
  const range = document.createRange();
  const selection = window.getSelection();
  let currentPos = 0;
  let found = false;
  
  function traverse(node) {
    if (found) return;
    if (node.nodeType === Node.TEXT_NODE) {
      const nextPos = currentPos + node.length;
      if (position <= nextPos) {
        range.setStart(node, position - currentPos);
        range.setEnd(node, position - currentPos);
        found = true;
        return;
      }
      currentPos = nextPos;
    } else {
      for (let i = 0; i < node.childNodes.length; i++) {
        traverse(node.childNodes[i]);
        if (found) return;
      }
    }
  }
  
  traverse(element);
  if (found) {
    selection.removeAllRanges();
    selection.addRange(range);
  }
}

setTimeout(() => {
  const bootDiv = document.querySelector('.terminal-boot');
  bootDiv.style.transition = 'opacity 0.5s';
  bootDiv.style.opacity = '0';
  setTimeout(() => {
    bootDiv.innerHTML = '<div class="boot-line" style="color:#00FF00;">SYSTEM_READY</div>';
    bootDiv.style.opacity = '1';
  }, 500);
}, 3000);

typingArea.focus();
</script>
</body>
</html>
