<!DOCTYPE html>
<html lang="fr">
<head>
<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22 fill=%22%230000AA%22>:v</text></svg>">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>RŒîFF~ŒûLLO_2Œ¶</title>
<link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'><text x='16' y='24' font-family='Courier New' font-size='20' font-weight='bold' fill='%230000AA' text-anchor='middle'>:V</text></svg>">
<style>
@keyframes blink {
  0%, 49% { opacity: 1; }
  50%, 100% { opacity: 0; }
}

@keyframes flicker {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.96; }
}

@keyframes scanline {
  0% { transform: translateY(-100%); }
  100% { transform: translateY(100vh); }
}

@keyframes socialPulse {
  0%, 100% { transform: scale(1); box-shadow: 1px 1px 0 #000000; }
  50% { transform: scale(1.05); box-shadow: 3px 3px 8px rgba(255, 255, 255, 0.6); }
}

@keyframes unfoldCover {
  from {
    max-height: 0;
    opacity: 0;
  }
  to {
    max-height: 400px;
    opacity: 1;
  }
}

@keyframes badgeGlow {
  0%, 100% { 
    transform: scale(1); 
    box-shadow: 2px 2px 0 #000000;
    filter: brightness(1);
  }
  50% { 
    transform: scale(1.1); 
    box-shadow: 0 0 15px #FFD700, 2px 2px 0 #000000;
    filter: brightness(1.2);
  }
}

* {
  cursor: none !important;
}

body {
  margin: 0;
  padding: 40px 20px;
  background-color: #0000AA;
  color: #FFFFFF;
  font-family: "Courier New", "Lucida Console", monospace;
  min-height: 100vh;
  width: 100vw;
  box-sizing: border-box;
  animation: flicker 0.15s infinite;
  text-shadow: 0 0 2px rgba(255, 255, 255, 0.5);
  position: relative;
  overflow-x: hidden;
}

body::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 2px;
  background: linear-gradient(transparent, rgba(255, 255, 255, 0.1), transparent);
  animation: scanline 8s linear infinite;
  pointer-events: none;
  z-index: 1000;
}

body::after {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: repeating-linear-gradient(
    0deg,
    rgba(0, 0, 0, 0.15),
    rgba(0, 0, 0, 0.15) 1px,
    transparent 1px,
    transparent 2px
  );
  pointer-events: none;
  z-index: 999;
}

.content-wrapper {
  position: relative;
  z-index: 1;
}

.logo {

  border: 2px solid #FFFFFF;
  display: inline-block;
  padding: 4px 16px;
  margin-bottom: 30px;
  transition: all 0.2s;
  cursor: pointer;
  text-decoration: none;
}

.logo:hover {
  background: #FFFFFF;
}


.logo span {
  background-color: #FFFFFF;
  color: #0000AA;
  padding: 0 4px;
  font-weight: bold;
}

.error-header {
  max-width: 900px;
  margin: 0 auto 30px auto;
  text-align: center;
  font-size: 1.3em;
  font-weight: bold;
  letter-spacing: 2px;
  border-bottom: 2px solid #FFFFFF;
  padding-bottom: 15px;
}

.error-code {
  font-size: 2em;
  margin-bottom: 10px;
}

.fiche {
  max-width: 900px;
  margin: 0 auto;
  border: 3px solid #FFFFFF;
  border-style: outset;
  padding: 25px;
  box-sizing: border-box;
  background-color: #0000AA;
  box-shadow: inset 0 0 20px rgba(255, 255, 255, 0.1), 4px 4px 0 rgba(0, 0, 0, 0.5);
}

.system-info {
  font-size: 0.85em;
  margin-bottom: 20px;
  padding: 10px;
  border: 1px solid #FFFFFF;
  background-color: rgba(0, 0, 100, 0.5);
}

.header {
  display: flex;
  align-items: flex-start;
  gap: 20px;
  flex-wrap: wrap;
  padding-bottom: 20px;
  border-bottom: 2px solid #FFFFFF;
  margin-bottom: 20px;
}

.avatar-container {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 0;
  position: relative;
}

.avatar {
  width: 120px;
  height: 120px;
  border: 3px solid #FFFFFF;
  background-color: #000088;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 3em;
  box-shadow: 0 0 15px #FFFFFF;
  background-size: cover;
  background-position: center;
  border-radius: 5px;
  transition: all 0.5s ease;
}

.avatar-flag {
  display: flex;
  width: 48px;
  height: 32px;
  border: 2px solid #FFFFFF;
  overflow: hidden;
  box-shadow: 2px 2px 0 rgba(0, 0, 0, 0.5);
  position: absolute;
  bottom: -16px;
  left: 50%;
  transform: translateX(-50%);
  background-color: #0000AA;
  z-index: 5;
}

.info {
  flex: 1;
  min-width: 250px;
}

.name {
  font-size: 1.6em;
  font-weight: bold;
  margin: 0 0 10px 0;
  letter-spacing: 1px;
}

.alias {
  font-size: 0.7em;
  color: #FFD700;
  font-style: italic;
}

.socials {
  margin: 15px 0;
}

.socials a {
  background-color: #C0C0C0;
  color: #000000;
  text-decoration: none;
  border: 2px solid;
  border-color: #FFFFFF #000000 #000000 #FFFFFF;
  padding: 5px 15px;
  font-size: 0.9em;
  font-weight: bold;
  display: inline-block;
  margin-right: 10px;
  margin-bottom: 5px;
  box-shadow: 1px 1px 0 #000000;
  font-family: "MS Sans Serif", "Lucida Console", monospace;
  animation: socialPulse 2s infinite;
}

.bio {
  margin-top: 15px;
  font-size: 0.95em;
  line-height: 1.6em;
  padding: 10px;
  border-left: 3px solid #FFFFFF;
  background-color: rgba(0, 0, 100, 0.3);
}

.stats-container {
  flex-shrink: 0;
  display: flex;
  justify-content: center;
  align-items: center;
  border: 2px solid #FFFFFF;
  padding: 15px;
  background-color: rgba(0, 0, 80, 0.5);
  min-width: 280px;
}

.radar-container {
  width: 250px;
  height: auto;
}

.radar-label {
  font-size: 11px;
  fill: #FFFFFF;
  font-family: "Courier New", monospace;
  font-weight: bold;
  cursor: help;
}

.radar-point {
  fill: #FFFFFF;
  filter: drop-shadow(0 0 3px #FFFFFF);
}

.tooltip {
  position: fixed;
  background-color: #FFFFE1;
  color: #000000;
  padding: 5px 10px;
  border: 1px solid #000000;
  font-size: 11px;
  pointer-events: none;
  z-index: 10000;
  display: none;
  font-family: "MS Sans Serif", "Courier New", monospace;
  box-shadow: 2px 2px 0 rgba(0, 0, 0, 0.5);
}

.category {
  margin-top: 20px;
  padding: 15px;
  border: 2px solid;
  border-color: #FFFFFF #000000 #000000 #FFFFFF;
  background: linear-gradient(135deg, rgba(0, 0, 100, 0.4) 0%, rgba(0, 0, 120, 0.3) 100%);
  box-shadow: 4px 4px 0 rgba(0, 0, 0, 0.5);
  transition: all 0.3s;
}

.category:hover {
  box-shadow: 6px 6px 0 rgba(0, 0, 0, 0.5);
  transform: translateY(-2px);
}

.category-title {
  font-weight: bold;
  font-size: 1.2em;
  margin-bottom: 10px;
  color: #FFFFFF;
  letter-spacing: 1px;
  text-transform: uppercase;
  border-bottom: 2px solid #FFFFFF;
  padding-bottom: 8px;
  text-shadow: 2px 2px #000000;
}

.stat-period-btn {
  background: #C0C0C0;
  border: 2px solid;
  border-color: #FFFFFF #000000 #000000 #FFFFFF;
  padding: 3px 10px;
  font-size: 11px;
  cursor: pointer;
  font-family: "Courier New", monospace;
  color: #000000;
  font-weight: bold;
  margin-left: 5px;
}
.stat-period-btn:hover {
  background: #DFDFDF;
}
.stat-period-btn.active {
  background: #000080;
  color: #FFFFFF;
  border-color: #000000 #FFFFFF #FFFFFF #000000;
}

.category-content {
  font-size: 0.95em;
  line-height: 1.8em;
  padding-left: 15px;
  font-family: "Courier New", monospace;
}

/* Citation */
.quote-simple {
  background: linear-gradient(135deg, rgba(255, 215, 0, 0.2), rgba(255, 255, 255, 0.1));
  border: 2px solid #FFD700;
  padding: 15px 20px;
  margin: 20px 0;
  display: flex;
  align-items: center;
  gap: 15px;
}

.quote-simple-text {
  flex: 1;
  font-style: italic;
  font-size: 1.1em;
}

.quote-simple-btn {
  background: #FFD700;
  border: 2px solid #000000;
  color: #000000;
  padding: 8px 15px;
  font-weight: bold;
  cursor: pointer;
  font-family: "Courier New", monospace;
}

.quote-simple-btn:hover {
  background: #FFFF00;
}

/* Livres */
.book-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
  gap: 15px;
  margin-top: 10px;
}

.book-card {
  background: #C0C0C0;
  padding: 10px;
  border: 2px solid #000000;
  cursor: pointer;
  transition: all 0.3s;
  position: relative;
  overflow: hidden;
}

.book-card:hover {
  transform: translateY(-5px);
  box-shadow: 5px 5px 0 #000000;
  border-color: #FFD700;
}

.book-info-text {
  position: relative;
  z-index: 2;
  background: #C0C0C0;
  padding: 5px;
}

.book-cover {
  width: 100%;
  height: 0;
  max-height: 0;
  overflow: hidden;
  border: 2px solid #000000;
  margin-bottom: 8px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: #808080;
  transition: max-height 0.5s ease, height 0.5s ease;
  opacity: 0;
}

.book-card:hover .book-cover {
  height: auto;
  max-height: none;
  opacity: 1;
  animation: unfoldCover 0.5s ease forwards;
}

.book-cover img {
  max-width: 100%;
  max-height: 200px;
  width: auto;
  height: auto;
  object-fit: contain;
}

.book-title {
  font-weight: bold;
  color: #000080;
  margin-bottom: 5px;
  font-size: 14px;
}

.book-info {
  font-size: 12px;
  color: #000000;
  margin-bottom: 8px;
}

.book-formats {
  display: flex;
  gap: 5px;
  margin-top: 8px;
}

.format-badge {
  background: #000080;
  color: #FFF;
  padding: 4px 8px;
  text-decoration: none;
  border: 1px solid #000000;
  cursor: pointer;
  display: inline-block;
  transition: all 0.2s;
  box-shadow: 1px 1px 0 #000000;
  font-size: 11px;
}

.format-badge:hover {
  background: #0000FF;
  transform: translateY(-2px);
  box-shadow: 2px 2px 0 #000000;
  border: 1px solid #FFFFFF;
}

/* Traductions */
.translation-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
  gap: 15px;
  margin-top: 10px;
}

.translation-card {
  background: #C0C0C0;
  padding: 10px;
  border: 2px solid #008000;
  cursor: pointer;
  transition: all 0.3s;
}

.translation-card:hover {
  transform: translateY(-5px);
  box-shadow: 5px 5px 0 #000000;
  border-color: #00FF00;
}

.translation-author {
  font-size: 11px;
  color: #008000;
  font-weight: bold;
  margin-bottom: 3px;
}

.translation-title {
  font-weight: bold;
  color: #000080;
  font-size: 13px;
  margin-bottom: 5px;
}

.translation-info {
  font-size: 11px;
  color: #000000;
}

/* Articles */
.article-filters {
  display: flex;
  gap: 10px;
  margin: 15px 0;
  flex-wrap: wrap;
}

.filter-btn {
  padding: 8px 16px;
  background: #C0C0C0;
  border: 2px solid;
  border-color: #FFFFFF #000000 #000000 #FFFFFF;
  color: #000000;
  font-weight: bold;
  cursor: pointer;
  font-family: "Courier New", monospace;
  font-size: 12px;
  transition: all 0.2s;
}

.filter-btn:hover {
  background: #DFDFDF;
}

.filter-btn.active {
  background: #000080;
  color: #FFFFFF;
  border-color: #000000 #FFFFFF #FFFFFF #000000;
}

.articles-dropdown {
  background: #C0C0C0;
  border: 2px solid #000000;
  padding: 10px;
  margin-top: 10px;
}

.article-item {
  background: #FFFFFF;
  padding: 10px;
  border: 2px solid #000000;
  color: #000000;
  cursor: pointer;
  margin-bottom: 8px;
  transition: all 0.2s;
}

.article-item:hover {
  background: #FFFFCC;
  transform: translateX(5px);
  box-shadow: 3px 3px 0 #000000;
}

.pagination-controls {
  display: flex;
  justify-content: center;
  gap: 10px;
  margin-top: 15px;
}

.pagination-btn {
  padding: 8px 20px;
  background: #C0C0C0;
  border: 2px solid;
  border-color: #FFFFFF #000000 #000000 #FFFFFF;
  color: #000000;
  font-weight: bold;
  cursor: pointer;
  font-family: "Courier New", monospace;
  font-size: 12px;
}

.pagination-btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.pagination-btn:hover:not(:disabled) {
  background: #DFDFDF;
}

/* Timeline - plus haute */
.timeline-graph-container {
  overflow-x: auto;
  padding: 10px;
  border: 2px solid;
  border-color: #000000 #FFFFFF #FFFFFF #000000;
  background-color: rgba(0, 0, 80, 0.5);
  box-shadow: inset 2px 2px 3px rgba(0, 0, 0, 0.5);
}

.graph-canvas {
  width: 100%;
  height: 100%;
}

.year-popup {
  position: fixed;
  background-color: #C0C0C0;
  border: 2px solid;
  border-color: #FFFFFF #000000 #000000 #FFFFFF;
  padding: 10px;
  font-size: 12px;
  z-index: 10000;
  display: none;
  max-width: 350px;
  box-shadow: 3px 3px 0 rgba(0, 0, 0, 0.5);
  color: #000000;
}

.year-popup-title {
  font-weight: bold;
  margin-bottom: 5px;
  border-bottom: 1px solid #000000;
  padding-bottom: 3px;
}

.year-popup-list {
  line-height: 1.5;
}

/* Badges */
.badge-item {
  background: #FFD700;
  color: #000000;
  padding: 5px 12px;
  font-size: 11px;
  border: 2px solid #000000;
  font-weight: bold;
  box-shadow: 2px 2px 0 #000000;
  display: inline-block;
  transition: all 0.3s;
  cursor: help;
  position: relative;
}

.badge-item:hover {
  animation: badgeGlow 0.8s ease-in-out infinite;
  z-index: 10;
}

.badge-item::after {
  content: attr(data-description);
  position: absolute;
  bottom: 100%;
  left: 50%;
  transform: translateX(-50%) translateY(-5px);
  background: #FFFFE1;
  color: #000000;
  padding: 5px 10px;
  border: 1px solid #000000;
  font-size: 11px;
  white-space: nowrap;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.3s, transform 0.3s;
  box-shadow: 2px 2px 0 rgba(0, 0, 0, 0.5);
  z-index: 1000;
}

.badge-item:hover::after {
  opacity: 1;
  transform: translateX(-50%) translateY(-10px);
}

/* Curseur */
.cursor {
  display: inline-block;
  width: 10px;
  height: 15px;
  background-color: #FFFFFF;
  animation: blink 1s infinite;
  margin-left: 5px;
}

.fake-cursor {
  position: fixed;
  width: 16px;
  height: 16px;
  background-color: #FFFFFF;
  pointer-events: none;
  z-index: 9999;
  mix-blend-mode: difference;
  display: none;
}

body:hover .fake-cursor {
  display: block;
}

/* Modal */
.modal-viewer {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  background: rgba(0, 0, 170, 0.95);
  z-index: 10000;
  justify-content: center;
  align-items: center;
  backdrop-filter: blur(2px);
}

.modal-viewer * {
  cursor: auto !important;
}

.modal-content {
  background: #C0C0C0;
  border: 3px solid;
  border-color: #FFFFFF #000000 #000000 #FFFFFF;
  max-width: 95%;
  max-height: 95%;
  width: 1000px;
  height: 800px;
  display: flex;
  flex-direction: column;
  box-shadow: 8px 8px 0 rgba(0, 0, 0, 0.7);
  position: relative;
  transition: all 0.3s ease;
}

.modal-content.fullscreen {
  width: 98vw !important;
  height: 98vh !important;
  max-width: 98vw !important;
  max-height: 98vh !important;
}

.modal-header {
  background: linear-gradient(to right, #000080, #1084D0);
  color: #FFFFFF;
  padding: 5px 10px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-weight: bold;
  flex-shrink: 0;
}

.modal-header-left {
  display: flex;
  align-items: center;
  gap: 8px;
}

.modal-icon {
  width: 16px;
  height: 16px;
  background: #FFFFFF;
  color: #000080;
  font-size: 12px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
}

.modal-header-right {
  display: flex;
  gap: 5px;
}

.modal-maximize {
  background: #C0C0C0;
  border: 2px solid;
  border-color: #FFFFFF #000000 #000000 #FFFFFF;
  padding: 2px 8px;
  cursor: pointer !important;
  font-weight: bold;
  color: #000000;
  font-size: 14px;
  min-width: 24px;
}

.modal-maximize:hover {
  background: #DFDFDF;
}

.modal-close {
  background: #C0C0C0;
  border: 2px solid;
  border-color: #FFFFFF #000000 #000000 #FFFFFF;
  padding: 2px 10px;
  cursor: pointer !important;
  font-weight: bold;
  color: #000000;
  font-size: 14px;
}

.modal-close:hover {
  background: #DFDFDF;
}

.modal-toolbar {
  background: #C0C0C0;
  padding: 8px;
  border-bottom: 2px solid #808080;
  display: flex;
  gap: 10px;
  flex-wrap: wrap;
  flex-shrink: 0;
}

.modal-body {
  flex: 1;
  overflow: auto;
  background: #FFFFFF;
  border: 2px solid;
  border-color: #808080 #FFFFFF #FFFFFF #808080;
  margin: 5px;
  position: relative;
}

.pdf-viewer {
  width: 100%;
  height: 100%;
  border: none;
}

.download-btn {
  background: #C0C0C0;
  border: 2px solid;
  border-color: #FFFFFF #000000 #000000 #FFFFFF;
  padding: 6px 16px;
  cursor: pointer !important;
  font-weight: bold;
  color: #000000;
  font-family: "Courier New", monospace;
  display: inline-block;
  text-decoration: none;
  font-size: 12px;
}

.download-btn:hover {
  background: #DFDFDF;
}

.footer-error {
  max-width: 900px;
  margin: 30px auto 0 auto;
  text-align: center;
  font-size: 0.85em;
  padding-top: 20px;
  border-top: 2px solid #FFFFFF;
}

@media (max-width: 768px) {
  .header {
    flex-direction: column;
    align-items: center;
  }
  
  .stats-container {
    width: 100%;
  }
  
  .error-code {
    font-size: 1.5em;
  }
  
  .book-grid, .translation-grid {
    grid-template-columns: 1fr;
  }
}
</style>
</head>
<body>

<div class="content-wrapper">
  <div class="fake-cursor" id="fakeCursor"></div>
  
  <a href="borne.html" style="text-decoration: none;">
    <a href="borne.html" class="logo"><span>:vitalism</span></a>
  </a>

  <div class="error-header">
    <div class="error-code">*** STOP: 0x0000VIRISM (0xRAFFAELLO, 0x00000002)</div>
    <div>PROFIL_SYSTEM_DATA</div>
  </div>

  <div class="fiche">
    <div class="system-info">
      *** Adresse: 0xBF7C2A84 base √† 0xBF7C0000, DateStamp 4a5bc600 - profil.sys<br>
      *** Synchronis√© avec: data.json | Derni√®re MAJ: <span id="lastUpdate">--</span>
    </div>

    <div class="header">
      <div class="avatar-container">
        <div class="avatar" id="mainAvatar"></div>
        <div class="avatar-flag">
          <!-- Drapeau italien -->
          <div style="width: 33.33%; background-color: #009246;"></div>
          <div style="width: 33.33%; background-color: #FFFFFF;"></div>
          <div style="width: 33.33%; background-color: #CE2B37;"></div>
        </div>
      </div>
      <div class="info">
        <p class="name">&gt; Raffaello Bellino<span class="cursor"></span></p>
        <span class="alias">alias "Il Maestro"</span>
        <div class="socials">
          <a href="https://x.com/RaffaelloBelli1" target="_blank">Twitter</a>
          <a href="https://lestroisetendards.com/" target="_blank">Website</a>
          <a href="https://lestroisetendards.com/2025/07/27/la-boutique-hermetique-achetez-des-livres-rares-confidentiels/" target="_blank">Boutique</a>
        </div>
        <div class="bio">
          &gt; STATUS: <span style="color: #00FF00; font-weight: bold;">‚óè ACTIF</span><br>
          &gt; √âcrivain prolifique et penseur vitaliste italien.<br>
          &gt; Auteur et traducteur d'≈ìuvres fondamentales.<br>
          &gt; <span style="color: #FFD700;">‚òÖ Membre vitaliste depuis 2007</span>
        </div>
      </div>
      <div class="stats-container">
        <svg class="radar-container" viewBox="0 0 250 250" id="radar-svg"></svg>
      </div>
    </div>

    <!-- Citation -->
    <div class="quote-simple">
      <div class="quote-simple-text" id="quoteSimpleText">"Cliquez pour r√©v√©ler une citation..."</div>
      <button class="quote-simple-btn" onclick="spinQuote()">üé≤</button>
    </div>

    <div class="category">
      <div class="category-title">üìö Biblioth√®que / Livres</div>
      <div class="category-content">
        <div class="book-grid" id="booksGrid"></div>
      </div>
    </div>

    <div class="category">
      <div class="category-title">üîÑ Traductions</div>
      <div class="category-content">
        <div class="translation-grid" id="translationsGrid"></div>
        <div class="pagination-controls">
          <button class="pagination-btn" id="prevTransBtn" onclick="changeTransPage(-1)">‚óÄ PR√âC√âDENT</button>
          <span id="transPageInfo" style="color: #FFFFFF; font-weight: bold;">Page 1</span>
          <button class="pagination-btn" id="nextTransBtn" onclick="changeTransPage(1)">SUIVANT ‚ñ∂</button>
        </div>
      </div>
    </div>

    <div class="category">
      <div class="category-title">üìÑ Articles & Essais</div>
      <div class="category-content">
        <div class="article-filters" id="articleFilters"></div>
        <div class="articles-dropdown" id="articlesContainer"></div>
        <div class="pagination-controls">
          <button class="pagination-btn" id="prevBtn" onclick="changePage(-1)">‚óÄ PR√âC√âDENT</button>
          <span id="pageInfo" style="color: #FFFFFF; font-weight: bold;">Page 1</span>
          <button class="pagination-btn" id="nextBtn" onclick="changePage(1)">SUIVANT ‚ñ∂</button>
        </div>
      </div>
    </div>

    <div class="category">
      <div class="category-title">üé• Vid√©os & Conf√©rences</div>
      <div class="category-content" id="videosContainer"></div>
    </div>

    <div class="category">
      <div class="category-title">üéß Audio & Podcasts</div>
      <div class="category-content" id="audioContainer"></div>
    </div>

    <div class="category">
      <div class="category-title">üê¶ Twitter/X Feed</div>
      <div class="category-content">
        <div id="tweetsContainer" style="min-height: 150px; background: #FFFFFF; padding: 10px; border: 2px solid; border-color: #808080 #FFFFFF #FFFFFF #808080;">
          <div style="text-align: center; padding: 20px; color: #000080;">
            <div style="font-size: 24px; margin-bottom: 10px;">üîÑ</div>
            <div>Chargement du feed Twitter/X...</div>
          </div>
        </div>
      </div>
    </div>

    <div class="category">
      <div class="category-title">*** Production Timeline</div>
      <div class="timeline-graph-container">
        <canvas class="graph-canvas" id="timelineCanvas"></canvas>
      </div>
    </div>

    <div class="category">
      <div class="category-title">*** Stats
        <span style="float: right;">
          <button class="stat-period-btn active" id="btnStatYear" onclick="showYearStats()">2025</button>
          <button class="stat-period-btn" id="btnStatMonth" onclick="showMonthStats()">MOIS</button>
        </span>
      </div>
      <div class="category-content">
        [0x01] Pages livres : <strong style="color: #FFD700;" id="stat-pages-livres">0</strong><br>
        [0x02] Pages traductions : <strong style="color: #00FF00;" id="stat-pages-trad">0</strong><br>
        [0x03] Pages articles : <strong style="color: #00BFFF;" id="stat-pages-articles">0</strong><br>
        [0x04] Vid√©o (min) : <strong style="color: #FF69B4;" id="stat-video-min">0</strong><br>
        [0x05] Audio (min) : <strong style="color: #FFA500;" id="stat-audio-min">0</strong><br>
        [0x06] Retweets : <strong style="color: #808080;" id="stat-retweets">0</strong><br>
        [0x07] Likes : <strong style="color: #808080;" id="stat-likes">0</strong><br>
        [0x08] Score : <strong style="color: #FF0000;" id="stat-score">0</strong>
      </div>
    </div>

    <div class="category">
      <div class="category-title">*** Achievements / Badges</div>
      <div class="category-content">
        <div id="badgesContainer" style="display: flex; gap: 10px; flex-wrap: wrap; margin-top: 10px;"></div>
      </div>
    </div>
  </div>

  <div class="footer-error">
    *** If this is the first time you have seen this screen, restart your computer.<br>
    *** If this screen appears again, follow these steps: contact the An√¥ne for more information.
  </div>
</div>

<!-- Modal Viewer -->
<div class="modal-viewer" id="modalViewer">
  <div class="modal-content" id="modalContent">
    <div class="modal-header">
      <div class="modal-header-left">
        <div class="modal-icon" id="modalIcon">üìÑ</div>
        <span id="modalTitle">Document</span>
      </div>
      <div class="modal-header-right">
        <div class="modal-maximize" onclick="toggleMaximize()" id="maximizeBtn">‚ñ°</div>
        <div class="modal-close" onclick="closeModal()">√ó</div>
      </div>
    </div>
    <div class="modal-toolbar">
      <a href="#" id="downloadPdf" class="download-btn" style="display:none;">üìÑ T√©l√©charger PDF</a>
      <a href="#" id="downloadEpub" class="download-btn" style="display:none;">üì± T√©l√©charger EPUB</a>
    </div>
    <div class="modal-body" id="modalBody"></div>
  </div>
</div>

<div class="tooltip" id="tooltip"></div>
<div class="year-popup" id="yearPopup"></div>

<script>
// Curseur personnalis√©
const fakeCursor = document.getElementById('fakeCursor');
document.addEventListener('mousemove', (e) => {
  fakeCursor.style.left = e.clientX + 'px';
  fakeCursor.style.top = e.clientY + 'px';
});

// Donn√©es
let statsData = null;
let contributorData = null;
let allArticles = [];
let filteredArticles = [];
let currentArticlePage = 0;
const articlesPerPage = 3;

let allTranslations = [];
let currentTransPage = 0;
const translationsPerPage = 3;

// Chargement des donn√©es
async function loadData() {
  try {
    const response = await fetch('data.json');
    const data = await response.json();
    statsData = data; // Stocker pour acc√®s global (formule scoring)
    contributorData = data.contributors.find(c => c.name === "Raffaello Bellino");
    
    if (!contributorData) {
      console.error('Contributeur Raffaello Bellino non trouv√©');
      return;
    }
    
    document.getElementById('lastUpdate').textContent = new Date(data.lastUpdate).toLocaleString('fr-FR');
    
    // Avatar
    const avatar = document.getElementById('mainAvatar');
    avatar.style.backgroundImage = `url('raffaello.jpg')`;
    
    // Initialiser
    drawRadar();
    updateBooks();
    updateTranslations();
    updateArticles();
    updateVideos();
    updateAudio();
    updateStats();
    updateBadges();
    drawTimeline();
    loadTwitterFeed();
    
  } catch (error) {
    console.error('Erreur de chargement:', error);
  }
}

loadData();

// Citations
function spinQuote() {
  const quoteText = document.getElementById('quoteSimpleText');
  if (contributorData && contributorData.quotes && contributorData.quotes.length > 0) {
    const quote = contributorData.quotes[Math.floor(Math.random() * contributorData.quotes.length)];
    quoteText.textContent = `"${quote}"`;
  }
}

// Formule de score
function getArticlePagesPerContributor(name) {
  switch(name) {
    case "Venehon": return 1;
    case "Caverne": return 5;
    case "Raffaello Bellino": return 5;
    default: return 3;
  }
}

function calculateScore(year) {
  const yearKey = 'y' + year;
  const data = contributorData[yearKey];
  if (!data) return 0;
  
  // R√©cup√©rer les poids depuis le JSON centralis√©
  const weights = statsData?.scoring?.weights || {
    page: 15, page_traduction: 7.5, video_minute: 7, audio_minute: 3.5, retweets: 1, likes: 0.3
  };
  
  const yearBooks = (contributorData.books || []).filter(b => b.year === year);
  const bookPages = yearBooks.reduce((sum, b) => sum + (b.pages || 0), 0);
  
  const yearTrans = (contributorData.translations || []).filter(t => t.year === year);
  const transPages = yearTrans.reduce((sum, t) => sum + (t.pages || 0), 0);
  
  let articleCount = data.articles || 0;
  const pagesPerArticle = getArticlePagesPerContributor(contributorData.name);
  const articlePages = articleCount * pagesPerArticle;
  
  // Minutes vid√©o et audio
  const videoMinutes = data.video_minutes || 0;
  const audioMinutes = data.audio_minutes || 0;
  
  // Nouvelle formule
  const score = (bookPages * weights.page) + 
                (transPages * weights.page_traduction) + 
                (articlePages * weights.page) + 
                (videoMinutes * weights.video_minute) + 
                (audioMinutes * weights.audio_minute) + 
                ((data.retweets || 0) * weights.retweets) + 
                ((data.likes || 0) * weights.likes);
  
  return Math.round(score);
}

function calculateTotalScore() {
  let total = 0;
  for (let y = 2007; y <= 2025; y++) {
    total += calculateScore(y);
  }
  return total;
}

// Livres
function updateBooks() {
  document.getElementById('booksGrid').innerHTML = contributorData.books.map(book => {
    const coverSrc = book.cover || book.title.toLowerCase().replace(/[^a-z0-9]/g, '') + '.jpg';
    return `
    <div class="book-card" onclick="openBookModal('${book.title.replace(/'/g, "\'")}', ${book.year}, ${book.pages}, '${book.pdf || ''}', '${book.epub || ''}')">
      <div class="book-cover">
        <img src="${coverSrc}" alt="${book.title}" onerror="this.style.display='none'">
      </div>
      <div class="book-info-text">
        <div class="book-title">${book.title}</div>
        <div class="book-info">${book.year} ‚Ä¢ ${book.pages} pages</div>
        <div class="book-formats">
          ${book.pdf ? '<a href="' + book.pdf + '" class="format-badge" download onclick="event.stopPropagation()">PDF</a>' : ''}
          ${book.epub ? '<a href="' + book.epub + '" class="format-badge" download onclick="event.stopPropagation()">EPUB</a>' : ''}
        </div>
      </div>
    </div>
  `}).join('');
}

// Traductions avec pagination
function updateTranslations() {
  allTranslations = contributorData.translations || [];
  renderTranslationsPage();
}

function renderTranslationsPage() {
  const start = currentTransPage * translationsPerPage;
  const pageTrans = allTranslations.slice(start, start + translationsPerPage);
  
  document.getElementById('translationsGrid').innerHTML = pageTrans.map(trans => {
    const parts = trans.title.split(' - ');
    const author = parts.length > 1 ? parts[0] : '';
    const title = parts.length > 1 ? parts.slice(1).join(' - ') : trans.title;
    
    return `
      <div class="translation-card" onclick="openTranslationModal('${trans.title.replace(/'/g, "\\'")}', ${trans.year}, ${trans.pages})">
        <div class="translation-author">${author}</div>
        <div class="translation-title">${title}</div>
        <div class="translation-info">${trans.year} ‚Ä¢ ${trans.pages} pages</div>
        <div class="book-formats" style="margin-top: 8px;">
          <span class="format-badge" style="background: #008000;">PDF</span>
        </div>
      </div>
    `;
  }).join('');
  
  const totalPages = Math.ceil(allTranslations.length / translationsPerPage) || 1;
  document.getElementById('transPageInfo').textContent = `Page ${currentTransPage + 1} / ${totalPages}`;
  document.getElementById('prevTransBtn').disabled = currentTransPage === 0;
  document.getElementById('nextTransBtn').disabled = currentTransPage >= totalPages - 1;
}

function changeTransPage(dir) {
  currentTransPage += dir;
  if (currentTransPage < 0) currentTransPage = 0;
  const maxPage = Math.ceil(allTranslations.length / translationsPerPage) - 1;
  if (currentTransPage > maxPage) currentTransPage = maxPage;
  renderTranslationsPage();
}

// Articles avec pagination
function updateArticles() {
  // V√©rifier si des articles d√©taill√©s existent dans le JSON
  const detailedArticles = contributorData.articles || [];
  
  if (detailedArticles.length > 0) {
    // Utiliser les articles d√©taill√©s du JSON
    allArticles = detailedArticles.map(a => ({
      title: a.title,
      year: a.year,
      date: a.date || `${a.year}`,
      pdf: a.pdf || ''
    }));
  } else {
    // G√©n√©rer un r√©sum√© par ann√©e (articles non d√©taill√©s)
    allArticles = [];
    for (let y = 2007; y <= 2025; y++) {
      const yearKey = 'y' + y;
      const data = contributorData[yearKey];
      if (data && data.articles > 0) {
        // Cr√©er une entr√©e r√©sum√©e pour chaque ann√©e
        allArticles.push({ 
          title: `${data.articles} articles publi√©s`, 
          year: y, 
          date: `${y}`,
          isYearSummary: true,
          count: data.articles
        });
      }
    }
  }
  
  filteredArticles = [...allArticles];
  const years = [...new Set(allArticles.map(a => a.year))].sort().reverse();
  
  // Calculer le total d'articles
  let totalArticleCount = 0;
  if (detailedArticles.length > 0) {
    totalArticleCount = detailedArticles.length;
  } else {
    for (let y = 2007; y <= 2025; y++) {
      const data = contributorData['y' + y];
      if (data) totalArticleCount += data.articles || 0;
    }
  }
  
  document.getElementById('articleFilters').innerHTML = `
    <button class="filter-btn active" onclick="filterArticlesByYear('all')">TOUS (${totalArticleCount})</button>
    ${years.map(y => {
      let count;
      if (detailedArticles.length > 0) {
        count = allArticles.filter(a => a.year === y).length;
      } else {
        count = (contributorData['y' + y] || {}).articles || 0;
      }
      return `<button class="filter-btn" onclick="filterArticlesByYear(${y})">${y} (${count})</button>`;
    }).join('')}
  `;
  
  renderArticlesPage();
}

function filterArticlesByYear(year) {
  document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
  event.target.classList.add('active');
  filteredArticles = year === 'all' ? [...allArticles] : allArticles.filter(a => a.year === year);
  currentArticlePage = 0;
  renderArticlesPage();
}

function renderArticlesPage() {
  const start = currentArticlePage * articlesPerPage;
  const pageArticles = filteredArticles.slice(start, start + articlesPerPage);
  
  // V√©rifier si ce sont des articles d√©taill√©s ou des r√©sum√©s
  const hasDetailedArticles = pageArticles.length > 0 && !pageArticles[0].isYearSummary;
  
  if (hasDetailedArticles) {
    // Affichage des articles d√©taill√©s (cliquables)
    document.getElementById('articlesContainer').innerHTML = pageArticles.map(article => `
      <div class="article-item" ${article.pdf ? `onclick="openArticleModal('${article.title.replace(/'/g, "\\'")}', '${article.date}', '${article.pdf}')"` : ''} style="${article.pdf ? 'cursor: pointer;' : ''}">
        <div style="display: flex; justify-content: space-between; align-items: center;">
          <div>
            <strong>‚úçÔ∏è ${article.title}</strong>
            <div style="font-size: 0.85em; color: #000080;">${article.date}</div>
          </div>
          ${article.pdf ? `<span class="format-badge" style="background: #008000;">PDF</span>` : ''}
        </div>
      </div>
    `).join('');
  } else {
    // Affichage des r√©sum√©s par ann√©e (avec lien vers le site)
    document.getElementById('articlesContainer').innerHTML = pageArticles.map(article => `
      <div class="article-item" onclick="window.open('https://lestroisetendards.com/', '_blank')" style="cursor: pointer;">
        <div style="display: flex; justify-content: space-between; align-items: center;">
          <div>
            <strong>üìÖ ${article.year} - ${article.title}</strong>
            <div style="font-size: 0.85em; color: #000080;">Cliquez pour voir sur lestroisetendards.com</div>
          </div>
          <span style="font-size: 24px;">üîó</span>
        </div>
      </div>
    `).join('');
  }
  
  // Calculer le nombre total d'articles pour la pagination
  let displayCount = filteredArticles.length;
  if (!hasDetailedArticles && filteredArticles.length > 0) {
    displayCount = filteredArticles.reduce((sum, a) => sum + (a.count || 1), 0);
  }
  
  const totalPages = Math.ceil(filteredArticles.length / articlesPerPage) || 1;
  document.getElementById('pageInfo').textContent = `Page ${currentArticlePage + 1} / ${totalPages} (${displayCount} articles)`;
  document.getElementById('prevBtn').disabled = currentArticlePage === 0;
  document.getElementById('nextBtn').disabled = currentArticlePage >= totalPages - 1;
}

function changePage(dir) {
  currentArticlePage += dir;
  if (currentArticlePage < 0) currentArticlePage = 0;
  const maxPage = Math.ceil(filteredArticles.length / articlesPerPage) - 1;
  if (currentArticlePage > maxPage) currentArticlePage = maxPage;
  renderArticlesPage();
}

// Stats
let statPeriod = 'year';

function showYearStats() {
  statPeriod = 'year';
  document.getElementById('btnStatYear').classList.add('active');
  document.getElementById('btnStatMonth').classList.remove('active');
  updateStats();
}

function showMonthStats() {
  statPeriod = 'month';
  document.getElementById('btnStatMonth').classList.add('active');
  document.getElementById('btnStatYear').classList.remove('active');
  updateStats();
}

function updateStats() {
  const currentYear = new Date().getFullYear();
  const monthKeys = ['janvier', 'fevrier', 'mars', 'avril', 'mai', 'juin', 
                     'juillet', 'aout', 'septembre', 'octobre', 'novembre', 'decembre'];
  const currentMonthKey = monthKeys[new Date().getMonth()];
  
  // R√©cup√©rer les poids depuis le JSON centralis√©
  const weights = statsData.scoring?.weights || {
    page: 15, page_traduction: 7.5, video_minute: 7, audio_minute: 3.5, retweets: 1, likes: 0.3
  };
  
  if (statPeriod === 'year') {
    // Stats de l'ann√©e
    const yearKey = 'y' + currentYear;
    const yearData = contributorData[yearKey] || {};
    
    // Pages des livres de l'ann√©e
    const booksThisYear = (contributorData.books || []).filter(b => b.year === currentYear);
    const pagesLivres = booksThisYear.reduce((sum, b) => sum + (b.pages || 0), 0);
    
    // Pages des traductions de l'ann√©e
    const transThisYear = (contributorData.translations || []).filter(t => t.year === currentYear);
    const pagesTrad = transThisYear.reduce((sum, t) => sum + (t.pages || 0), 0);
    
    // Pages des articles de l'ann√©e (depuis tableau OU depuis yXXXX.articles)
    let pagesArticles = 0;
    const articlesArray = contributorData.articles || [];
    if (articlesArray.length > 0) {
      const articlesThisYear = articlesArray.filter(a => a.year === currentYear);
      pagesArticles = articlesThisYear.reduce((sum, a) => sum + (a.pages || 3), 0);
    } else {
      // Pas de tableau d√©taill√©, utiliser le compteur yXXXX.articles √ó 3 pages
      const articlesCount = yearData.articles || 0;
      pagesArticles = articlesCount * 3;
    }
    
    const videoMin = yearData.video_minutes || 0;
    const audioMin = yearData.audio_minutes || 0;
    
    document.getElementById('stat-pages-livres').textContent = pagesLivres;
    document.getElementById('stat-pages-articles').textContent = pagesArticles;
    document.getElementById('stat-video-min').textContent = videoMin;
    document.getElementById('stat-audio-min').textContent = audioMin;
    document.getElementById('stat-retweets').textContent = yearData.retweets || 0;
    document.getElementById('stat-likes').textContent = yearData.likes || 0;
    
    // Afficher aussi les traductions si pr√©sentes
    const statTradEl = document.getElementById('stat-pages-trad');
    if (statTradEl) statTradEl.textContent = pagesTrad;
    
    // Score avec nouvelle formule incluant traductions
    const yearScore = (pagesLivres * weights.page) + 
                      (pagesTrad * weights.page_traduction) +
                      (pagesArticles * weights.page) + 
                      (videoMin * weights.video_minute) + 
                      (audioMin * weights.audio_minute) + 
                      ((yearData.retweets || 0) * weights.retweets) + 
                      ((yearData.likes || 0) * weights.likes);
    document.getElementById('stat-score').textContent = Math.round(yearScore);
    
  } else {
    // Stats du mois
    const monthData = contributorData.months?.[currentMonthKey] || {};
    
    document.getElementById('stat-pages-livres').textContent = monthData.pages_livres || 0;
    document.getElementById('stat-pages-articles').textContent = monthData.pages_articles || 0;
    document.getElementById('stat-video-min').textContent = monthData.video_minutes || 0;
    document.getElementById('stat-audio-min').textContent = monthData.audio_minutes || 0;
    document.getElementById('stat-retweets').textContent = monthData.retweets || 0;
    document.getElementById('stat-likes').textContent = monthData.likes || 0;
    
    const pagesTradMonth = monthData.pages_traductions || 0;
    const statTradEl = document.getElementById('stat-pages-trad');
    if (statTradEl) statTradEl.textContent = pagesTradMonth;
    
    // Score du mois avec nouvelle formule
    const monthScore = ((monthData.pages_livres || 0) * weights.page) + 
                       ((pagesTradMonth) * weights.page_traduction) +
                       ((monthData.pages_articles || 0) * weights.page) + 
                       ((monthData.video_minutes || 0) * weights.video_minute) + 
                       ((monthData.audio_minutes || 0) * weights.audio_minute) + 
                       ((monthData.retweets || 0) * weights.retweets) + 
                       ((monthData.likes || 0) * weights.likes);
    document.getElementById('stat-score').textContent = Math.round(monthScore);
  }
}

// Vid√©os
function updateVideos() {
  const videos = contributorData.videos || [];
  if (videos.length === 0) {
    document.getElementById('videosContainer').innerHTML = '<div style="color: #808080; padding: 20px; text-align: center;">Aucune vid√©o disponible</div>';
    return;
  }
  document.getElementById('videosContainer').innerHTML = `
    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 15px; margin-top: 10px;">
      ${videos.map(v => `
        <div style="background: #C0C0C0; padding: 10px; border: 2px solid #000000; cursor: pointer;">
          <div style="background: #000000; height: 120px; display: flex; align-items: center; justify-content: center; margin-bottom: 8px;">
            <div style="font-size: 3em;">‚ñ∂Ô∏è</div>
          </div>
          <div style="font-weight: bold; color: #000080;">${v.title}</div>
          <div style="font-size: 0.85em; color: #000000; margin-top: 5px;">${v.year} ‚Ä¢ ${v.duration}</div>
          <a href="${v.file}" class="format-badge" style="display: inline-block; margin-top: 8px; background: #FF69B4;" download onclick="event.stopPropagation()">‚¨áÔ∏è MP4</a>
        </div>
      `).join('')}
    </div>
  `;
}

// Audio
function updateAudio() {
  const audios = contributorData.audio || [];
  if (audios.length === 0) {
    document.getElementById('audioContainer').innerHTML = '<div style="color: #808080; padding: 20px; text-align: center;">Aucun audio disponible</div>';
    return;
  }
  document.getElementById('audioContainer').innerHTML = `
    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 15px; margin-top: 10px;">
      ${audios.map(a => `
        <div style="background: #C0C0C0; padding: 10px; border: 2px solid #000000; cursor: pointer;">
          <div style="background: #1a1a2e; height: 80px; display: flex; align-items: center; justify-content: center; margin-bottom: 8px;">
            <div style="font-size: 2.5em;">üéß</div>
          </div>
          <div style="font-weight: bold; color: #000080;">${a.title}</div>
          <div style="font-size: 0.85em; color: #000000; margin-top: 5px;">${a.year} ‚Ä¢ ${a.duration}</div>
          <a href="${a.file}" class="format-badge" style="display: inline-block; margin-top: 8px; background: #FFA500;" download onclick="event.stopPropagation()">‚¨áÔ∏è MP3</a>
        </div>
      `).join('')}
    </div>
  `;
}

// Badges
function updateBadges() {
  const totalScore = calculateTotalScore();
  const books = (contributorData.books || []).length;
  
  const badges = [];
  if (totalScore > 100000) badges.push({ icon: 'üèÜ', name: 'LEGEND', desc: 'Score > 100 000', bg: '#FFD700' });
  if (books >= 5) badges.push({ icon: 'üìö', name: 'BOOK MASTER', desc: '5+ livres publi√©s', bg: '#FFD700' });
  if (allTranslations.length >= 5) badges.push({ icon: 'üîÑ', name: 'TRANSLATOR', desc: '5+ traductions', bg: '#00FF00' });
  if (allArticles.length >= 1000) badges.push({ icon: '‚úçÔ∏è', name: 'PROLIFIC', desc: '1000+ articles', bg: '#C0C0C0' });
  badges.push({ icon: 'üî•', name: 'VITALISTE', desc: 'Membre depuis 2007', bg: '#FF6600' });
  
  document.getElementById('badgesContainer').innerHTML = badges.map(b => `
    <span class="badge-item" style="background: ${b.bg};" data-description="${b.desc}">
      ${b.icon} ${b.name}
    </span>
  `).join('');
}

// Radar
function drawRadar() {
  const svg = document.getElementById("radar-svg");
  svg.innerHTML = "";
  
  const radar = contributorData.radar;
  const branches = [
    {name: "RAIS", fullName: "Raisonnement", value: radar.raisonnement},
    {name: "ETH", fullName: "√âthique", value: radar.ethique},
    {name: "LOG", fullName: "Logique", value: radar.logique},
    {name: "ESTH", fullName: "Esth√©tique", value: radar.esthetique},
    {name: "META", fullName: "M√©taphysique", value: radar.metaphysique},
    {name: "SOC", fullName: "Sociologie", value: radar.sociologie}
  ];

  const cX = 125, cY = 125, maxR = 80, levels = 4;

  for(let i = 1; i <= levels; i++){
    const r = (maxR / levels) * i;
    const circle = document.createElementNS("http://www.w3.org/2000/svg", "circle");
    circle.setAttribute("cx", cX);
    circle.setAttribute("cy", cY);
    circle.setAttribute("r", r);
    circle.setAttribute("stroke", "#FFFFFF");
    circle.setAttribute("stroke-width", "1");
    circle.setAttribute("fill", "none");
    circle.setAttribute("opacity", "0.4");
    svg.appendChild(circle);
  }

  const total = branches.length;
  const pts = [];
  const tooltip = document.getElementById('tooltip');

  branches.forEach((b, i) => {
    const angle = (i / total) * 2 * Math.PI - Math.PI / 2;
    
    const lx2 = cX + maxR * Math.cos(angle);
    const ly2 = cY + maxR * Math.sin(angle);
    const line = document.createElementNS("http://www.w3.org/2000/svg", "line");
    line.setAttribute("x1", cX);
    line.setAttribute("y1", cY);
    line.setAttribute("x2", lx2);
    line.setAttribute("y2", ly2);
    line.setAttribute("stroke", "#FFFFFF");
    line.setAttribute("stroke-width", "1");
    line.setAttribute("opacity", "0.5");
    svg.appendChild(line);

    const rad = maxR * (b.value / 100);
    pts.push([cX + rad * Math.cos(angle), cY + rad * Math.sin(angle)]);

    const lR = maxR + 28;
    const text = document.createElementNS("http://www.w3.org/2000/svg", "text");
    text.setAttribute("x", cX + lR * Math.cos(angle));
    text.setAttribute("y", cY + lR * Math.sin(angle));
    text.textContent = b.name;
    text.setAttribute("class", "radar-label");
    
    const cosA = Math.cos(angle);
    if(cosA > 0.2) text.setAttribute("text-anchor", "start");
    else if(cosA < -0.2) text.setAttribute("text-anchor", "end");
    else text.setAttribute("text-anchor", "middle");
    text.setAttribute("alignment-baseline", "middle");
    
    text.addEventListener('mouseenter', () => {
      tooltip.innerHTML = `<strong>${b.fullName}</strong>: ${b.value}%`;
      tooltip.style.display = 'block';
    });
    text.addEventListener('mousemove', (e) => {
      tooltip.style.left = (e.clientX + 10) + 'px';
      tooltip.style.top = (e.clientY + 10) + 'px';
    });
    text.addEventListener('mouseleave', () => tooltip.style.display = 'none');
    
    svg.appendChild(text);
  });
  
  const poly = document.createElementNS("http://www.w3.org/2000/svg", "polygon");
  poly.setAttribute("points", pts.map(p => p.join(",")).join(" "));
  poly.setAttribute("fill", "rgba(255, 255, 255, 0.4)");
  poly.setAttribute("stroke", "#FFFFFF");
  poly.setAttribute("stroke-width", "2.5");
  svg.appendChild(poly);
  
  pts.forEach(([x, y]) => {
    const pt = document.createElementNS("http://www.w3.org/2000/svg", "circle");
    pt.setAttribute("cx", x);
    pt.setAttribute("cy", y);
    pt.setAttribute("r", 4);
    pt.setAttribute("class", "radar-point");
    svg.appendChild(pt);
  });
}

// Timeline - plus haute (400px)
function drawTimeline() {
  const canvas = document.getElementById('timelineCanvas');
  const ctx = canvas.getContext('2d');
  canvas.width = 2000;
  canvas.height = 400; // Plus haute
  
  const years = [];
  for (let y = 2007; y <= 2025; y++) years.push(y);
  
  const productionData = {};
  years.forEach(year => {
    productionData[year] = {
      score: calculateScore(year),
      articles: (contributorData['y' + year] || {}).articles || 0
    };
  });
  
  const scores = years.map(y => productionData[y].score);
  const maxScore = Math.max(...scores, 1);
  const padding = 60;
  const graphWidth = canvas.width - padding * 2;
  const graphHeight = canvas.height - padding * 2 - 80;
  const stepX = graphWidth / (years.length - 1);
  
  // Grille
  ctx.strokeStyle = 'rgba(255, 255, 255, 0.2)';
  ctx.lineWidth = 1;
  for(let i = 0; i <= 5; i++){
    const y = padding + (graphHeight / 5) * i;
    ctx.beginPath();
    ctx.moveTo(padding, y);
    ctx.lineTo(canvas.width - padding, y);
    ctx.stroke();
  }
  
  // Axes
  ctx.strokeStyle = '#FFFFFF';
  ctx.lineWidth = 2;
  ctx.beginPath();
  ctx.moveTo(padding, padding);
  ctx.lineTo(padding, canvas.height - padding - 70);
  ctx.lineTo(canvas.width - padding, canvas.height - padding - 70);
  ctx.stroke();
  
  // Labels Y
  ctx.fillStyle = '#FFFFFF';
  ctx.font = '14px "Courier New"';
  ctx.textAlign = 'right';
  for(let i = 0; i <= 5; i++){
    const val = Math.round((maxScore / 5) * i);
    const y = canvas.height - padding - 70 - (graphHeight / maxScore) * val;
    ctx.fillText(val.toLocaleString('fr-FR'), padding - 10, y + 4);
  }
  
  // Labels X et scores
  ctx.font = 'bold 16px "Courier New"';
  ctx.textAlign = 'center';
  years.forEach((year, i) => {
    const x = padding + stepX * i;
    
    ctx.fillStyle = '#FFFFFF';
    ctx.fillText(year, x, canvas.height - padding - 50);
    
    const scoreText = `‚òÖ ${productionData[year].score.toLocaleString('fr-FR')}`;
    ctx.font = 'bold 14px "Courier New"';
    const textWidth = ctx.measureText(scoreText).width;
    
    ctx.fillStyle = '#000000';
    ctx.fillRect(x - textWidth/2 - 4, canvas.height - padding - 35, textWidth + 8, 20);
    ctx.strokeStyle = '#FFD700';
    ctx.lineWidth = 2;
    ctx.strokeRect(x - textWidth/2 - 4, canvas.height - padding - 35, textWidth + 8, 20);
    ctx.fillStyle = '#FFD700';
    ctx.fillText(scoreText, x, canvas.height - padding - 20);
    
    ctx.font = 'bold 16px "Courier New"';
  });
  
  // Courbe
  ctx.strokeStyle = '#FFFFFF';
  ctx.fillStyle = 'rgba(255, 255, 255, 0.3)';
  ctx.lineWidth = 3;
  ctx.beginPath();
  ctx.moveTo(padding, canvas.height - padding - 70);
  
  const points = [];
  years.forEach((year, i) => {
    const x = padding + stepX * i;
    const y = canvas.height - padding - 70 - (graphHeight / maxScore) * scores[i];
    points.push({x, y, year, data: productionData[year]});
    ctx.lineTo(x, y);
  });
  
  ctx.lineTo(canvas.width - padding, canvas.height - padding - 70);
  ctx.closePath();
  ctx.fill();
  ctx.stroke();
  
  // Points
  points.forEach(p => {
    ctx.beginPath();
    ctx.arc(p.x, p.y, 8, 0, Math.PI * 2);
    ctx.fillStyle = '#FFFFFF';
    ctx.fill();
    ctx.strokeStyle = '#0000AA';
    ctx.lineWidth = 2;
    ctx.stroke();
  });
  
  // Popup
  const yearPopup = document.getElementById('yearPopup');
  canvas.addEventListener('mousemove', (e) => {
    const rect = canvas.getBoundingClientRect();
    const scaleX = canvas.width / rect.width;
    const scaleY = canvas.height / rect.height;
    const mouseX = (e.clientX - rect.left) * scaleX;
    const mouseY = (e.clientY - rect.top) * scaleY;
    let found = false;
    
    points.forEach(p => {
      if (Math.sqrt((mouseX - p.x) ** 2 + (mouseY - p.y) ** 2) < 50) {
        found = true;
        yearPopup.style.display = 'block';
        yearPopup.style.left = (e.clientX + 10) + 'px';
        yearPopup.style.top = (e.clientY + 10) + 'px';
        yearPopup.innerHTML = `
          <div class="year-popup-title">üìÖ ${p.year}</div>
          <div class="year-popup-list">
            <strong style="color: #FF0000;">‚ö° SCORE: ${p.data.score.toLocaleString('fr-FR')}</strong><br>
            ‚úçÔ∏è Articles: ${p.data.articles}
          </div>
        `;
      }
    });
    
    if (!found) yearPopup.style.display = 'none';
  });
  
  canvas.addEventListener('mouseleave', () => yearPopup.style.display = 'none');
}

// Twitter
function loadTwitterFeed() {
  const container = document.getElementById('tweetsContainer');
  container.innerHTML = `
    <a class="twitter-timeline" data-height="400" data-theme="light" data-chrome="noheader nofooter noborders" data-tweet-limit="5" href="https://twitter.com/RaffaelloBelli1">Tweets</a>
  `;
  if (!document.querySelector('script[src*="platform.twitter.com"]')) {
    const script = document.createElement('script');
    script.src = 'https://platform.twitter.com/widgets.js';
    script.async = true;
    document.head.appendChild(script);
  }
}

// Modal
function openBookModal(title, year, pages) {
  document.getElementById('fakeCursor').style.display = 'none';
  document.getElementById('modalIcon').textContent = 'üìñ';
  document.getElementById('modalTitle').textContent = title;
  document.getElementById('downloadPdf').style.display = 'inline-block';
  document.getElementById('downloadPdf').href = '#';
  document.getElementById('downloadEpub').style.display = 'inline-block';
  document.getElementById('downloadEpub').href = '#';
  document.getElementById('modalBody').innerHTML = `
    <div style="padding: 50px; text-align: center; color: #000;">
      <div style="font-size: 4em; margin-bottom: 20px;">üìñ</div>
      <h2>${title}</h2>
      <p style="font-size: 1.2em;">${year} ‚Ä¢ ${pages} pages</p>
      <p style="margin-top: 30px; color: #666;">Fichier PDF √† configurer</p>
    </div>
  `;
  document.getElementById('modalViewer').style.display = 'flex';
}

function openArticleModal(title, date, pdfUrl) {
  document.getElementById('fakeCursor').style.display = 'none';
  document.getElementById('modalIcon').textContent = '‚úçÔ∏è';
  document.getElementById('modalTitle').textContent = title;
  
  // Afficher le bouton PDF si disponible
  if (pdfUrl && pdfUrl !== '') {
    document.getElementById('downloadPdf').style.display = 'inline-block';
    document.getElementById('downloadPdf').href = pdfUrl;
    document.getElementById('downloadPdf').download = pdfUrl;
  } else {
    document.getElementById('downloadPdf').style.display = 'none';
  }
  document.getElementById('downloadEpub').style.display = 'none';
  
  // Afficher le PDF dans un iframe si disponible
  if (pdfUrl && pdfUrl !== '') {
    document.getElementById('modalBody').innerHTML = `
      <iframe src="${pdfUrl}" class="pdf-viewer" frameborder="0">
        <p>Votre navigateur ne supporte pas l'affichage de PDF. <a href="${pdfUrl}" download>T√©l√©charger le fichier</a></p>
      </iframe>
    `;
  } else {
    document.getElementById('modalBody').innerHTML = `
      <div style="padding: 50px; text-align: center; color: #000;">
        <div style="font-size: 4em; margin-bottom: 20px;">‚úçÔ∏è</div>
        <h2>${title}</h2>
        <p style="font-size: 1.2em;">${date}</p>
        <p style="margin-top: 30px; color: #666;">PDF non disponible</p>
        <a href="https://lestroisetendards.com/" target="_blank" style="display: inline-block; margin-top: 20px; padding: 10px 20px; background: #000080; color: #FFF; text-decoration: none; border: 2px solid #000;">Voir sur lestroisetendards.com</a>
      </div>
    `;
  }
  
  document.getElementById('modalViewer').style.display = 'flex';
}

function openTranslationModal(title, year, pages) {
  document.getElementById('fakeCursor').style.display = 'none';
  document.getElementById('modalIcon').textContent = 'üîÑ';
  document.getElementById('modalTitle').textContent = title;
  document.getElementById('downloadPdf').style.display = 'inline-block';
  document.getElementById('downloadPdf').href = '#';
  document.getElementById('downloadEpub').style.display = 'none';
  document.getElementById('modalBody').innerHTML = `
    <div style="padding: 50px; text-align: center; color: #000;">
      <div style="font-size: 4em; margin-bottom: 20px;">üîÑ</div>
      <h2>Traduction</h2>
      <h3>${title}</h3>
      <p style="font-size: 1.2em;">${year} ‚Ä¢ ${pages} pages</p>
      <p style="margin-top: 30px; color: #666;">Fichier PDF √† configurer</p>
    </div>
  `;
  document.getElementById('modalViewer').style.display = 'flex';
}

function closeModal() {
  document.getElementById('modalViewer').style.display = 'none';
  document.getElementById('modalBody').innerHTML = '';
  document.getElementById('modalContent').classList.remove('fullscreen');
  setTimeout(() => document.getElementById('fakeCursor').style.display = 'block', 100);
}

function toggleMaximize() {
  const modal = document.getElementById('modalContent');
  const btn = document.getElementById('maximizeBtn');
  if (modal.classList.contains('fullscreen')) {
    modal.classList.remove('fullscreen');
    btn.textContent = '‚ñ°';
  } else {
    modal.classList.add('fullscreen');
    btn.textContent = '‚ùê';
  }
}

document.addEventListener('keydown', (e) => {
  if(e.key === 'Escape') closeModal();
});
</script>

</body>
</html>
