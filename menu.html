<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Bluejeanism</title>
<style>
  html, body {
    margin: 0;
    padding: 0;
    height: 100vh;
    background-color: #0000AA;
    color: #FFFFFF;
    font-family: "Lucida Console", monospace;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    overflow: hidden;
    position: relative;
  }

  .logo {
    border: 2px solid #FFFFFF;
    display: inline-block;
    padding: 4px 16px;
    margin-bottom: 30px;
  }
  .logo span {
    background-color: #FFFFFF;
    color: #0000AA;
    padding: 0 4px;
    font-weight: bold;
  }

  img {
    max-width: 50%;
    transition: transform 0.5s ease;
    margin-bottom: 30px;
    border: 2px solid #FFFFFF;
    display: none;
  }

  .buttons button {
    background: #C0C0C0;
    border-top: 2px solid #FFFFFF;
    border-left: 2px solid #FFFFFF;
    border-bottom: 2px solid #808080;
    border-right: 2px solid #808080;
    padding: 10px 25px;
    font-family: "Lucida Console", monospace;
    font-size: 1.1em;
    font-weight: normal;
    color: #000000;
    cursor: pointer;
  }
  .buttons button:active {
    border-top: 2px solid #808080;
    border-left: 2px solid #808080;
    border-bottom: 2px solid #FFFFFF;
    border-right: 2px solid #FFFFFF;
    background: #C0C0C0;
  }

  .popup {
    position: fixed;
    width: 300px;
    background: #C0C0C0;
    border: 2px solid #FFFFFF;
    box-shadow: 2px 2px #000000 inset;
    font-family: "Lucida Console", monospace;
    z-index: 10;
    cursor: grab;
    display: none;
  }

  .popupTitle {
    background: #000080;
    color: white;
    padding: 5px;
    font-weight: normal;
    border-bottom: 2px solid #FFFFFF;
    cursor: grab;
  }

  .popupMessage {
    padding: 10px;
    color: black;
  }

  .popupButtons {
    display: flex;
    justify-content: flex-end;
    gap: 10px;
    padding: 5px 10px;
  }

  .popupButtons button {
    background: #C0C0C0;
    border-top: 2px solid #FFFFFF;
    border-left: 2px solid #FFFFFF;
    border-bottom: 2px solid #808080;
    border-right: 2px solid #808080;
    padding: 5px 10px;
    font-family: "Lucida Console", monospace;
    font-weight: normal;
    cursor: pointer;
    color: #000000;
  }
  .popupButtons button:active {
    border-top: 2px solid #808080;
    border-left: 2px solid #808080;
    border-bottom: 2px solid #FFFFFF;
    border-right: 2px solid #FFFFFF;
    background: #C0C0C0;
  }
</style>
</head>
<body>

<div class="logo"><span>bluejeanism</span></div>

<img id="mainImage" src="sydney.png" alt="Image">

<div class="buttons">
  <button id="leftButton">Bluepill</button>
  <button id="rightButton">Redpill</button>
</div>

<!-- Pop-up gauche -->
<div id="popupLeft" class="popup">
  <div class="popupTitle">Attention</div>
  <div class="popupMessage">Voulez-vous vraiment abandonner et fermer l'onglet ?</div>
  <div class="popupButtons">
    <button id="popupLeftYes">Oui</button>
    <button id="popupLeftNo">Non</button>
  </div>
</div>

<audio id="clicSound" src="click.mp3"></audio>

<script>
let stage = 0;
const image = document.getElementById('mainImage');
const leftButton = document.getElementById('leftButton');
const rightButton = document.getElementById('rightButton');
const popupLeft = document.getElementById('popupLeft');
const clicSound = document.getElementById('clicSound');

function playClick() {
  clicSound.currentTime = 0;
  clicSound.play();
}

// Mettre à jour zoom et texte du bouton droite
function updateStage() {
  const scaleMap = [0.05, 0.4, 1, 1];
  const textMap = ["Redpill ?", "REDPILL ???", "Tellement de retour", "Repertoire"];

  const index = Math.min(stage - 1, scaleMap.length - 1);
  image.style.transform = `scale(${scaleMap[index]})`;
  rightButton.textContent = textMap[index];
}

// Bouton Gauche
leftButton.onclick = function() {
  playClick();
  if(stage > 1){
    stage--;
    updateStage();
  } else {
    popupLeft.style.display = "block";
    popupLeft.style.top = "50%";
    popupLeft.style.left = "50%";
    popupLeft.style.transform = "translate(-50%, -50%)";
  }
}

// Bouton Droite
rightButton.onclick = function() {
  playClick();
  stage++;
  if(stage === 1) image.style.display = "block";

  // Pop-ups multiples uniquement pour "Tellement de retour"
  if(stage === 4){
    showAllPopups();
    return;
  }

  if(stage >= 4){
    window.location.href = "repertoire.html";
    return;
  }

  updateStage();
}

// Pop-up gauche
document.getElementById('popupLeftYes').onclick = function() {
  playClick();
  window.location.href = "about:blank";
}
document.getElementById('popupLeftNo').onclick = function() {
  playClick();
  popupLeft.style.display = "none";
}

// Pop-ups multiples
const popupMessages = [
  { text: "Voulez-vous accéder au répertoire ?", action: "repertoire.html" },
  { text: "Voulez-vous rejoindre le chat ?", action: "chat.html" },
  { text: "Voulez-vous lire les livres ?", action: null },
  { text: "Voulez-vous explorer les archives ?", action: null },
  { text: "Voulez-vous envoyer un e-mail à l’anône ?", action: null },
  { text: "Voulez-vous revenir au menu principal ?", action: "alert" }
];

function showAllPopups(){
  const w = window.innerWidth;
  const h = window.innerHeight;

  popupMessages.forEach(msgObj => {
    const popup = document.createElement("div");
    popup.className = "popup";
    popup.style.display = "block";

    // Position aléatoire
    const left = Math.floor(Math.random() * (w - 320));
    const top = Math.floor(Math.random() * (h - 120));
    popup.style.left = left + "px";
    popup.style.top = top + "px";

    const content = document.createElement("div");
    content.className = "popupContent";

    const title = document.createElement("div");
    title.className = "popupTitle";
    title.textContent = "Question";

    const message = document.createElement("div");
    message.className = "popupMessage";
    message.textContent = msgObj.text;

    const buttonsDiv = document.createElement("div");
    buttonsDiv.className = "popupButtons";

    const yesBtn = document.createElement("button");
    yesBtn.textContent = "Oui";
    yesBtn.onclick = () => {
      document.body.removeChild(popup);
      if(msgObj.action === "repertoire.html") window.location.href = "repertoire.html";
	  else if(msgObj.action === "chat.html") window.location.href = "chat.html";
      else if(msgObj.action === "alert") alert("Ce site ne propose pas de menu principal, c'est con ! ¯\_(ツ)_/¯ ");
    };

    const noBtn = document.createElement("button");
    noBtn.textContent = "Non";
    noBtn.onclick = () => document.body.removeChild(popup);

    buttonsDiv.appendChild(yesBtn);
    buttonsDiv.appendChild(noBtn);

    content.appendChild(title);
    content.appendChild(message);
    content.appendChild(buttonsDiv);

    popup.appendChild(content);
    document.body.appendChild(popup);

    makeDraggable(popup);
  });
}

// Déplacer les pop-ups
function makeDraggable(elmnt) {
  const header = elmnt.querySelector(".popupTitle");
  let offsetX = 0, offsetY = 0, mouseX = 0, mouseY = 0;

  header.onmousedown = dragMouseDown;

  function dragMouseDown(e){
    e.preventDefault();
    mouseX = e.clientX;
    mouseY = e.clientY;
    document.onmouseup = closeDragElement;
    document.onmousemove = elementDrag;
  }

  function elementDrag(e){
    e.preventDefault();
    offsetX = mouseX - e.clientX;
    offsetY = mouseY - e.clientY;
    mouseX = e.clientX;
    mouseY = e.clientY;
    elmnt.style.top = (elmnt.offsetTop - offsetY) + "px";
    elmnt.style.left = (elmnt.offsetLeft - offsetX) + "px";
  }

  function closeDragElement(){
    document.onmouseup = null;
    document.onmousemove = null;
  }
}
</script>

</body>
</html>
